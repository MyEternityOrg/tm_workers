{% extends 'extworkers/base.html' %}
{% load static %}
{% load custom_tags %}

{% block content %}
    {% now "H" as current_hour %}
    <div class="card-body">
        <div class="d-inline p-2 bg-black bg-opacity-75 text-white">Подразделение: {{ enterprise }}</div>
        <div class="d-inline p-2 bg-black bg-opacity-75 text-white">Дата: {{ dts }}</div>
    </div>
    <div id="layoutSidenav_content">
        <main>
            <div class="container-fluid">
                <div class="card mb-4">
                    <div class="card-header"><i class="fas fa-table mr-1"></i>Список сотрудников</div>
                    <div class="card-body">
                        {% if object_list %}
                            <div class="table-responsive">
                                <table id="datatable" class="table table-bordered table-hover" width="100%"
                                       cellspacing="0">
                                    <thead>
                                    <tr>
                                        <th>Дата</th>
                                        <th>Номер магазина</th>
                                        <th>Адрес магазина</th>
                                        <th>Сотрудник ПРР</th>
                                        <th>Время начала работы</th>
                                        <th>Время завершения работы</th>
                                    </tr>
                                    </thead>
                                    <tbody>
                                    {% for item in object_list %}
                                        <tr class='clickable-row'
                                            data-href="{% url 'tm_workers:person_edit' item.enterprise.guid item.guid %}">
                                            <td>{{ item.dts }}</td>
                                            <td>{{ item.enterprise.enterprise_code }}</td>
                                            <td>{{ item.enterprise.name }}</td>
                                            <td>{{ item.person_name }}</td>
                                            <td>{{ item.f_time }}</td>
                                            <td>{{ item.t_time }}</td>
                                        </tr>
                                    {% endfor %}
                                    </tbody>
                                </table>
                            </div>
                            {% include 'extworkers/pagination.html' %}
                        {% else %}
                            <div class="card-footer">Список пуст. Добавьте сотрудника.</div>
                        {% endif %}
                        {% if current_hour|to_int < 12 %}
                            <div class="card-footer"><a href="{% url 'tm_workers:person_add' enterprise.guid %}">
                                <button class="btn btn-success">Добавить сотрудника ПРР.</button>
                            </a>
                            </div>
                        {% endif %}
                    </div>
                </div>
            </div>
        </main>
    </div>
{% endblock %}
{% block script %}
    <script src="{% static 'dist/js/jquery.tables_tm.js' %}"></script>
{% endblock %}